# ğŸ§  image-matching-on-trained-reference

Compare images against a precomputed reference set using deep features (ResNet18).  
All operations are offline and require no GPU.

> ğŸ‡©ğŸ‡ª [German version here](README_de.md)

---

## ğŸ“ Tagline
> Efficient, offline image similarity detection using a trained reference dataset.

---

## ğŸ“Œ Short Description
This tool scans new images and compares them against a trained set of reference images using ResNet18 feature vectors.  
If the similarity score exceeds a threshold, the image is marked as a match.

---

## ğŸ¯ Use Case

This tool was developed to identify scanned images containing postal envelopes based on their overall visual appearance (e.g. shape, contrast, layout, quantity).  
It compares new images against a trained reference set to detect visual similarity, not exact duplication.

Typical applications:
- Detecting images that share a common layout or structure
- Flagging images that likely contain known object types (e.g. envelopes)
- Pre-sorting or tagging scanned materials by visual pattern

---

## ğŸ”§ Features
- Offline operation (no cloud, no network needed)
- Uses pretrained ResNet18 for feature extraction
- Compares new images recursively from folders
- Automatically renames matched files
- Configurable similarity threshold

---

## ğŸ“ Project Structure

```
project-root/
â”œâ”€â”€ images/              # Training/reference images
â”œâ”€â”€ zu_pruefen/          # Images to scan
â”œâ”€â”€ traning.py           # Builds features.npy and filenames.npy
â”œâ”€â”€ main.py              # Compares images and renames matches
â”œâ”€â”€ features.npy         # Saved feature vectors (generated)
â””â”€â”€ filenames.npy        # Saved filenames (generated)
```

---

## ğŸ§ª Usage

1. Put reference images into the `images/` folder.
2. Run the training script:
   ```bash
   python traning.py
   ```
3. Put new images (including subfolders) into `zu_pruefen/`.
4. Run the main script:
   ```bash
   python main.py
   ```

---

## âš™ï¸ Requirements

Install all dependencies with:

```bash
pip install torch torchvision scikit-learn numpy pillow
```

Dependencies are also listed in `requirements.txt`.

---

## ğŸ§  Internals

- Feature vectors are 512-dimensional, generated by ResNet18 (feature part only).
- Cosine similarity is used to compare vectors.
- Matching threshold is configurable (default: 0.89).
- Identified matches are renamed to `Match_<originalname>.jpg`.

---

## ğŸ“Œ Notes

- All operations are performed offline.
- Designed for image sets with high visual consistency.
- ResNet18 weights are loaded locally via torchvision.
